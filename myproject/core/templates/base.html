{% load static %}

<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <title>{% block title %}Mi Mercado{% endblock %}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="{% static 'css/style.css' %}">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>

<body data-bs-theme="dark">
  <!--New Navbar-->
  <header>
    {% if messages %}
    <div class="container mt-3">
        {% for message in messages %}
        <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
            {{ message }}
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
        {% endfor %}
    </div>
    {% endif %}
    {% if user.is_authenticated %}
    <div class="px-3 py-2 text-bg-dark border-bottom">
      <div class="container">
        <div
          class="d-flex flex-wrap align-items-center justify-content-center justify-content-lg-start"
        >
          <a
            href="/"
            class="d-flex align-items-center my-2 my-lg-0 me-lg-auto text-white text-decoration-none"
          >
            <svg
              class="bi me-2"
              width="40"
              height="32"
              role="img"
              aria-label="Bootstrap"
            >
              <use xlink:href="#bootstrap"></use>
            </svg>
          </a>
          <ul
            class="nav col-12 col-lg-auto my-2 justify-content-center my-md-0 text-small"
          >
            <li>
              <a 
                href="{% url 'home' %}" 
                class="nav-link text-white {% if request.resolver_match.url_name == 'home' %}active{% endif %}"
              >
                <svg
                  class="bi d-block mx-auto mb-1"
                  width="24"
                  height="24"
                  aria-hidden="true"
                >
              <symbol id="home" viewBox="0 0 16 16">
                  <path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293zM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5z" fill="white"/>
              </symbol>
                  <use xlink:href="#home"></use>
                </svg>
                Home
              </a>
            </li>
            <li>
              <a 
                href="{% url 'market:my_product_list' %}" 
                class="nav-link text-white {% if request.resolver_match.url_name == 'my_product_list' %}active{% endif %}"
              >
                <svg
                  class="bi d-block mx-auto mb-1"
                  width="24"
                  height="24"
                  aria-hidden="true"
                >
              <symbol id="tools" viewBox="0 0 16 16">
                <path d="M1 0 0 1l2.2 3.081a1 1 0 0 0 .815.419h.07a1 1 0 0 1 .708.293l2.675 2.675-2.617 2.654A3.003 3.003 0 0 0 0 13a3 3 0 1 0 5.878-.851l2.654-2.617.968.968-.305.914a1 1 0 0 0 .242 1.023l3.27 3.27a.997.997 0 0 0 1.414 0l1.586-1.586a.997.997 0 0 0 0-1.414l-3.27-3.27a1 1 0 0 0-1.023-.242L10.5 9.5l-.96-.96 2.68-2.643A3.005 3.005 0 0 0 16 3q0-.405-.102-.777l-2.14 2.141L12 4l-.364-1.757L13.777.102a3 3 0 0 0-3.675 3.68L7.462 6.46 4.793 3.793a1 1 0 0 1-.293-.707v-.071a1 1 0 0 0-.419-.814zm9.646 10.646a.5.5 0 0 1 .708 0l2.914 2.915a.5.5 0 0 1-.707.707l-2.915-2.914a.5.5 0 0 1 0-.708M3 11l.471.242.529.026.287.445.445.287.026.529L5 13l-.242.471-.026.529-.445.287-.287.445-.529.026L3 15l-.471-.242L2 14.732l-.287-.445L1.268 14l-.026-.529L1 13l.242-.471.026-.529.445-.287.287-.445.529-.026z" fill="white"/>
              </symbol>
                  <use xlink:href="#tools"></use>
                </svg>
                Administrar Productos
              </a>
            </li>
            <li>
              <a 
                href="{% url 'market:product_list' %}" 
                class="nav-link text-white {% if request.resolver_match.url_name == 'product_list' %}active{% endif %}"
              >
                <svg
                  class="bi d-block mx-auto mb-1"
                  width="24"
                  height="24"
                  aria-hidden="true"
                >
              <symbol id="shop" viewBox="0 0 16 16">
                <path d="M2.97 1.35A1 1 0 0 1 3.73 1h8.54a1 1 0 0 1 .76.35l2.609 3.044A1.5 1.5 0 0 1 16 5.37v.255a2.375 2.375 0 0 1-4.25 1.458A2.37 2.37 0 0 1 9.875 8 2.37 2.37 0 0 1 8 7.083 2.37 2.37 0 0 1 6.125 8a2.37 2.37 0 0 1-1.875-.917A2.375 2.375 0 0 1 0 5.625V5.37a1.5 1.5 0 0 1 .361-.976zm1.78 4.275a1.375 1.375 0 0 0 2.75 0 .5.5 0 0 1 1 0 1.375 1.375 0 0 0 2.75 0 .5.5 0 0 1 1 0 1.375 1.375 0 1 0 2.75 0V5.37a.5.5 0 0 0-.12-.325L12.27 2H3.73L1.12 5.045A.5.5 0 0 0 1 5.37v.255a1.375 1.375 0 0 0 2.75 0 .5.5 0 0 1 1 0M1.5 8.5A.5.5 0 0 1 2 9v6h1v-5a1 1 0 0 1 1-1h3a1 1 0 0 1 1 1v5h6V9a.5.5 0 0 1 1 0v6h.5a.5.5 0 0 1 0 1H.5a.5.5 0 0 1 0-1H1V9a.5.5 0 0 1 .5-.5M4 15h3v-5H4zm5-5a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1zm3 0h-2v3h2z" fill="white"/>
              </symbol>
                <use xlink:href="#shop"></use>
                </svg>
                Tienda
              </a>
            </li>
            <li>
              <a 
                href="#" 
                class="nav-link text-white {% if request.resolver_match.url_name == 'ai_chat' or request.resolver_match.url_name == 'price_suggest' %}active{% endif %}" 
                data-bs-toggle="dropdown"
              >
                <svg
                  class="bi d-block mx-auto mb-1"
                  width="24"
                  height="24"
                  aria-hidden="true"
                >
                <symbol id="robot" viewBox="0 0 16 16">
                  <path d="M6 12.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 0 1h-3a.5.5 0 0 1-.5-.5M3 8.062C3 6.76 4.235 5.765 5.53 5.886a26.6 26.6 0 0 0 4.94 0C11.765 5.765 13 6.76 13 8.062v1.157a.93.93 0 0 1-.765.935c-.845.147-2.34.346-4.235.346s-3.39-.2-4.235-.346A.93.93 0 0 1 3 9.219zm4.542-.827a.25.25 0 0 0-.217.068l-.92.9a25 25 0 0 1-1.871-.183.25.25 0 0 0-.068.495c.55.076 1.232.149 2.02.193a.25.25 0 0 0 .189-.071l.754-.736.847 1.71a.25.25 0 0 0 .404.062l.932-.97a25 25 0 0 0 1.922-.188.25.25 0 0 0-.068-.495c-.538.074-1.207.145-1.98.189a.25.25 0 0 0-.166.076l-.754.785-.842-1.7a.25.25 0 0 0-.182-.135" fill="white"/>
                  <path d="M8.5 1.866a1 1 0 1 0-1 0V3h-2A4.5 4.5 0 0 0 1 7.5V8a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1v1a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2v-1a1 1 0 0 0 1-1V9a1 1 0 0 0-1-1v-.5A4.5 4.5 0 0 0 10.5 3h-2zM14 7.5V13a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V7.5A3.5 3.5 0 0 1 5.5 4h5A3.5 3.5 0 0 1 14 7.5" fill="white"/>
                </symbol>
                  <use xlink:href="#robot"></use>
                </svg>
                IA â¯†
              </a>
              <ul class="dropdown-menu text-small shadow">
                <li><a class="dropdown-item" href="{% url 'market_ai:ai_chat' %}">Chat</a></li>
                <li><a class="dropdown-item" href="{% url 'market_ai:price_suggest' %}">Sugerir Precio</a></li>
              </ul>
            </li>
            <li>
              <a 
                href="{% url 'market:view_cart' %}" 
                class="nav-link text-white {% if request.resolver_match.url_name == 'view_cart' %}active{% endif %}"
              >
                <svg
                  class="bi d-block mx-auto mb-1"
                  width="24"
                  height="24"
                  aria-hidden="true"
                >
                <symbol id="cart" viewBox="0 0 16 16">
                <path d="M0 1.5A.5.5 0 0 1 .5 1H2a.5.5 0 0 1 .485.379L2.89 3H14.5a.5.5 0 0 1 .491.592l-1.5 8A.5.5 0 0 1 13 12H4a.5.5 0 0 1-.491-.408L2.01 3.607 1.61 2H.5a.5.5 0 0 1-.5-.5M3.102 4l1.313 7h8.17l1.313-7zM5 12a2 2 0 1 0 0 4 2 2 0 0 0 0-4m7 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4m-7 1a1 1 0 1 1 0 2 1 1 0 0 1 0-2m7 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2" fill="white"/>
                </symbol>
                  <use xlink:href="#cart"></use>
                </svg>
                Carrito
              </a>
            </li>
            <li>
              <a 
                href="{% url 'market:wishlist' %}" 
                class="nav-link text-white {% if request.resolver_match.url_name == 'wishlist' %}active{% endif %}"
              >
                <svg
                  class="bi d-block mx-auto mb-1"
                  width="24"
                  height="24"
                  aria-hidden="true"
                >
                <symbol id="bookmark-heart" viewBox="0 0 16 16">
                  <path fill-rule="evenodd" d="M8 4.41c1.387-1.425 4.854 1.07 0 4.277C3.146 5.48 6.613 2.986 8 4.412z" fill="white"/>
                  <path d="M2 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v13.5a.5.5 0 0 1-.777.416L8 13.101l-5.223 2.815A.5.5 0 0 1 2 15.5zm2-1a1 1 0 0 0-1 1v12.566l4.723-2.482a.5.5 0 0 1 .554 0L13 14.566V2a1 1 0 0 0-1-1z" fill="white"/>
                </symbol>
                  <use xlink:href="#bookmark-heart"></use>
                </svg>
                Wishlist
              </a>
            </li>
            <li>
              <a
                href="#"
                class="d-block link-body-emphasis text-decoration-none dropdown-toggle"
                data-bs-toggle="dropdown"
                aria-expanded="false"
              >
                {% if user.profile.avatar %}
                  <img src="{{ user.profile.avatar.url }}" 
                      alt="Avatar" 
                      class="rounded-circle" 
                      width="56" height="56"
                      style="object-fit: cover;">
                {% else %}
                  <img src="https://ui-avatars.com/api/?name={{ user.username }}&background=random" 
                      alt="Avatar" 
                      class="rounded-circle"
                      style="margin-top: 10px;margin-left: 10px;" 
                      width="48" height="48">
                {% endif %}
              </a>
              <ul class="dropdown-menu text-small">
                <li><a class="dropdown-item" href="{% url 'profile' %}">Perfil</a></li>
                <li><hr class="dropdown-divider" /></li>
                <li>
                  <form method="post" action="{% url 'logout' %}" class="d-inline">
                  {% csrf_token %}
                  <button class="dropdown-item" type="submit">Cerrar SesiÃ³n</button>
                  </form>
                </li>
            </li>
          </ul>
        </div>
      </div>
    </div>
    {% endif %}
    {% comment %} {% if not user.is_authenticated %}
    <div class="px-3 py-2 border-bottom mb-3">
      <div class="container d-flex flex-wrap justify-content-end">
        <form
          class="col-12 col-lg-auto mb-2 mb-lg-0 me-lg-auto"
          role="search"
        >
          <input
            type="search"
            class="form-control bg-dark text-white border-secondary"
            placeholder="Buscar..."
            aria-label="Search"
          />
        </form>
          <div class="text-end">
            <a href="{% url 'account_login' %}" type="button" class="btn btn-light text-dark me-2">
              Acceder
            </a>
            <a href="{% url 'account_signup' %}" type="button" class="btn btn-primary">
              Crear Cuenta
            </a>
        {% endif %}
        </div>
      </div>
    </div> {% endcomment %}
  </header>

  <!-- Content -->
  {% block no_main %}
  <main class="container my-4">
    {% block content %}{% endblock %}
  </main>
  {% endblock no_main %}

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>